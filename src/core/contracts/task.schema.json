{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://aura.dev/schemas/task.v1.json",
  "version": "1.0.0",
  "title": "Task",
  "description": "A discrete unit of work to be executed by Aura",
  "type": "object",
  "required": ["id", "version", "type", "description", "context", "constraints"],
  "additionalProperties": false,
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^task-[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$",
      "description": "Unique task identifier (UUID v4 with 'task-' prefix)"
    },
    "version": {
      "type": "string",
      "enum": ["1.0.0"],
      "description": "Schema version this task adheres to"
    },
    "type": {
      "type": "string",
      "enum": ["feature", "bugfix", "refactor", "docs", "test", "infra"],
      "description": "Category of work being requested"
    },
    "description": {
      "type": "string",
      "minLength": 10,
      "maxLength": 500,
      "description": "Clear, actionable description of what needs to be done"
    },
    "context": {
      "type": "object",
      "required": ["repository", "branch", "files"],
      "additionalProperties": false,
      "properties": {
        "repository": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9_-]+/[a-zA-Z0-9_-]+$",
          "description": "Repository in format: owner/repo"
        },
        "branch": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9/_-]+$",
          "description": "Target branch for this work"
        },
        "files": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^[a-zA-Z0-9/_.-]+$"
          },
          "description": "Files relevant to this task (paths relative to repo root)"
        },
        "dependencies": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^task-[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$"
          },
          "description": "Task IDs that must complete before this one"
        }
      }
    },
    "constraints": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "maxDuration": {
          "type": "integer",
          "minimum": 60,
          "maximum": 3600,
          "description": "Maximum execution time in seconds"
        },
        "requiresApproval": {
          "type": "boolean",
          "default": true,
          "description": "Whether plan must be approved before execution"
        },
        "breakingChangesAllowed": {
          "type": "boolean",
          "default": false,
          "description": "Whether breaking API changes are permitted"
        },
        "testCoverageMin": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "default": 80,
          "description": "Minimum test coverage percentage required"
        }
      }
    },
    "metadata": {
      "type": "object",
      "properties": {
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp of task creation"
        },
        "createdBy": {
          "type": "string",
          "description": "User or system that created this task"
        },
        "priority": {
          "type": "string",
          "enum": ["low", "medium", "high", "critical"],
          "default": "medium"
        },
        "labels": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    }
  },
  "examples": [
    {
      "id": "task-a1b2c3d4-e5f6-7890-abcd-ef1234567890",
      "version": "1.0.0",
      "type": "feature",
      "description": "Add user authentication using Supabase Auth with email/password and magic link support",
      "context": {
        "repository": "acme-corp/web-app",
        "branch": "feature/auth",
        "files": [
          "src/lib/auth.ts",
          "src/app/api/auth/route.ts",
          "src/middleware.ts"
        ]
      },
      "constraints": {
        "maxDuration": 1800,
        "requiresApproval": true,
        "breakingChangesAllowed": false,
        "testCoverageMin": 85
      },
      "metadata": {
        "createdAt": "2025-12-30T10:00:00Z",
        "createdBy": "virgilio@aura.dev",
        "priority": "high",
        "labels": ["auth", "security", "backend"]
      }
    }
  ]
}
